<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Busca de Tweets</title>
</head>
<body>
    <h1>Busca de Tweets</h1>

    <form method="post">
        <label for="hashtag">Hashtag:</label>
        <input type="text" name="hashtag" id="hashtag" placeholder="#Trump">
        <button type="submit">Buscar</button>
    </form>

    {% if tweets is iterable %}
        {% if tweets[0] is defined %}
            <h2>Resultados:</h2>
            <ul>
                {% for tweet in tweets %}
                    <li id="tweet-{{ tweet.id }}">
                        {{ tweet.text }}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            {% if tweets.message is defined %}
                <p>{{ tweets.message }}</p>
            {% else %}
                <p>{{ tweets|json_encode }}</p>
            {% endif %}
        {% endif %}
    {% else %}
        <p>{{ tweets }}</p>
    {% endif %}
    
    <script>
        function updateSentiments() {
            fetch('/tweets/sentiments')
                .then(response => response.json())
                .then(data => {
                    data.forEach(item => {
                        // 'item.id' deve ser a string ou valor do ID do tweet
                        const el = document.getElementById('tweet-' + item.id);
                        if (el) {
                            el.textContent = item.sentiment;
                        }
                    });
                })
                .catch(error => console.error('Erro ao atualizar sentimentos:', error));
        }
        setInterval(updateSentiments, 5000);
    </script>
</body>
</html>
